<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="main">

	<typeAlias alias="slide" type="main.bean.SlideDTO" />
	<typeAlias alias="theme" type="theme.ThemeDTO"/>
	  <typeAlias alias="comment" type="theme.CommentDTO" />
	
		<resultMap id="slideRes" class="slide">
		  	<result property="orgname" column="orgname"/>
		  	<result property="no" column="no"/>
		  	<result property="filetime" column="filetime"/>
		  	<result property="fileaddr" column="fileaddr"/>
		</resultMap>
		<resultMap id="cateGory" class="theme">
		  	<result property="no" column="no"/>
		  	<result property="name" column="name"/>
		  	<result property="file_orgname" column="file_orgname"/>
		  	<result property="file_savname" column="file_savname"/>
		  	<result property="readhit" column="readhit"/>
		  	<result property="good" column="good"/>
		  	<result property="hate" column="hate"/>
		  	<result property="regdate" column="regdate"/>
		</resultMap>
		
		  <!--  -->
  <resultMap class="comment" id="c">
    <result property="comment_no" column="comment_no"/>
  	<result property="board_num" column="board_num"/>
    <result property="mem_id" column="mem_id"/>
    <result property="content" column="content"/>
    <result property="reg" column="reg"/>
  </resultMap>
	
	<select id="slidecount" resultClass="int">
		select count(*) from slide
	</select>
	<select id="catecount" resultClass="int" parameterClass="String">
		select count(*) from courseinfo where id=#id#
	</select>
	<select id="fileselect" resultClass="int" parameterClass="slide">
		select count(*) from slide where orgname=#orgname#
	</select>
	<insert id="slideinsert" parameterClass="slide">
    		insert into slide(
    			orgname,
    			no,
    			filetime,
    			fileaddr
    		)
    		values(
    			#orgname#,
    			slide_no_seq.NEXTVAL,
    			#filetime#,
    			#fileaddr#
    		)
    </insert>
    <insert id="cateinsert" parameterClass="slide">
    		insert into cate(
    			orgname2,
    			no2,
    			filetime2,
    			fileaddr2
    		)
    		values(
    			#orgname2#,
    			category_no_seq.NEXTVAL,
    			#filetime2#,
    			#fileaddr2#
    		)
    </insert>
	<select id="selectAll" resultMap="slideRes">
		SELECT * FROM SLIDE ORDER BY no DESC
	</select>
	<select id="cateselect" resultMap="cateGory" parameterClass="String">
		SELECT * FROM COURSEINFO where id=#id# ORDER BY num DESC
	</select>
	<select id="no" resultMap="slideRes">
		SELECT NO FROM SLIDE ORDER BY NO DESC
	</select>
	<select id="sldel" resultClass="slide" parameterClass="String">
		select * from slide where no=#c#
	</select>
	<select id="cadel" resultClass="slide" parameterClass="String">
		select * from cate where no2=#c#
	</select>
	<delete id="slidedelete" parameterClass="String">
			DELETE FROM SLIDE WHERE no = #c#
   	</delete>
   	<delete id="categorydelete" parameterClass="String">
			DELETE FROM CATE WHERE no2 = #c#
   	</delete>
   	
   <select id="commentAll" resultMap="c">
    select * from (select * from comments order by reg desc) where 10 >= rownum
  </select>
</sqlMap>